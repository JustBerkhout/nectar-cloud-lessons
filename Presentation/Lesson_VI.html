<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>NeCTAR Cloud Lessons</title>

    <meta name="description" content="Slides for an introductory course on the NeCTAR cloud.">
    <meta name="author" content="Martin Paulo">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="revealjs/css/reveal.css">
    <link rel="stylesheet" href="revealjs/css/theme/solarized.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="revealjs/lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'revealjs/css/print/pdf.css' : 'revealjs/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="revealjs/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
<!-- Slides go here -->
<style type="text/css">.reveal ol {list-style-type: upper-alpha;}</style>
<section data-markdown><script type="text/template">

## Lesson VI: Snapshots, backups and vertical scaling (30 min)

http://tinyurl.com/rc-issue-14

</script></section>
<section data-markdown><script type="text/template">

## Exercise 1

Can you make a snapshot of your running VM?

Find the snapshot button next to your running instance of Drupal, and make a snapshot of it. Give it a useful name
that will allow you to know what it is when you come back to it weeks later.

</script></section>
<section data-markdown><script type="text/template">

## Exercise 2

In home directory, run the script `loop.sh` by:

``` bash
./loop.sh
```

Watch the output as you make a snapshot of your instance!

When done kill the script by hitting the `Ctrl` and `C` keys together. 

</script></section>
<section data-markdown><script type="text/template">

## Thought experiment

Why does the loop resume well before the dashboard shows the snapshot is complete?

</script></section>
<section data-markdown><script type="text/template">

## Question 1 

Why does Ben think snapshots are broken?

1. They are just too easy to do: suspicious enough!
1. The magic nostrums aren't up to the task!
1. Ben likes a life more complicated
1. The state of the machine is not captured
1. Cosmic rays can flip their bits.

</script></section>
<section data-markdown><script type="text/template">

## Exercise 3

Delete your older, possibly unreliable, snapshot.

</script></section>
<section data-markdown><script type="text/template">

## Exercise 4

Power down your vm *by shutting it off!*

<span style="color:red">*Do not terminate it!*</span>
 
Then when it is in the shutoff state, make a snapshot of it.

</script></section>
<section data-markdown><script type="text/template">

## Question 2 

What's a big problem with Anna's new approach?

1. You may forget to start your instance up again
1. The powered off machine might not have saved its state properly
1. The saved disk image is powerless
1. The process overhead is too high
1. How can you make a copy of a powered off disk?

</script></section>
<section data-markdown><script type="text/template">

## Group Exercise 

Create a checklist for creating a snapshot of a running machine. 
Don't forget to notify your users!

</script></section>
<section data-markdown><script type="text/template">

## Exercise 5

Terminate your running instance, then go to the images tab of your project
and launch a new instance using the snapshot that you have just created.
 
Once you are done make sure that your site is back up, and that you can ssh into the instance again.

Confirm that `today.txt` has your edits in it...

</script></section>
<section data-markdown><script type="text/template">

## Question 3

Anna's raft of kitten photographs has made it to the front page of the internet. Her server is struggling under the 
load. What can Anna do to solve this problem?

1. Nothing
1. Upgrade to a more powerful machine
1. Buy a physical machine and port her site to it
1. Make a support call to NeCTAR
1. Pay NeCTAR for more network

</script></section>
<section data-markdown><script type="text/template">

## Exercise 6

Terminate your running instance, and launch a new one 
using the snapshot that you have just created. 

But this time round, use the largest flavor
that your project will allow you.

</script></section>
<section data-markdown><script type="text/template">

## Question 4 

You'll notice that in your personal tenancy you can't run the largest machine image that you might want to.
What can you do to remedy this situation?

1. Nothing
1. Offer NeCTAR a load of money 
1. Reach for your credit card and call Amazon
1. Make a support call to NeCTAR
1. Go to the allocation tab and complete an allocation request

</script></section>
<section data-markdown><script type="text/template">

## Question 5

A volunteer please: to describe an image, an instance, and the difference between the two...

</script></section>
    </div>

</div>

<script src="revealjs/lib/js/head.min.js"></script>
<script src="revealjs/js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'revealjs/lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'revealjs/plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'revealjs/plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'revealjs/plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'revealjs/plugin/zoom-js/zoom.js', async: true},
            {src: 'revealjs/plugin/notes/notes.js', async: true}
        ]
    });

</script>

</body>
</html>
